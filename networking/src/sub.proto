syntax = "proto3";
import "rootsdk/types.proto";

service SubscriptionService {
  // Returns both external provider tiers and Root community roles
  rpc GetTiers(rootsdk.Void) returns (TierList);
  rpc SaveMapping(MappingRequest) returns (rootsdk.Void);
  rpc TriggerManualSync(rootsdk.Void) returns (SyncResponse);
}

message RootRole {
  string id = 1;
  string name = 2;
}

message Tier {
  string id = 1;
  string name = 2;
  string provider = 3;
}

message Mapping {
  string tier_id = 1;
  string role_id = 2;
  string provider = 3;
}

message TierList {
  repeated Tier tiers = 1;
  repeated RootRole roles = 2;
  repeated Mapping existing_mappings = 3;
}

message MappingRequest {
  string tier_id = 1;
  string role_id = 2;
  string provider = 3;
}

message SyncResponse {
  bool success = 1;
  string message = 2;
  repeated string roles_added = 3;
  repeated string roles_removed = 4;
}